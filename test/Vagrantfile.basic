Vagrant.configure("2") do |config|
    config.vm.box = "perk/ubuntu-2204-arm64"

    config.vm.provider "qemu" do |qe|
        # Default is:
        # qe.ssh_port = "50022"
        # Default is:
        # qe.machine = "virt,accel=hvf,highmem=off"

        qe.machine = "virt,accel=hvf,highmem=off"
        qe.cpu = "host"
        qe.memory = "3072"  # 3GB if you have 16GB+ M2
        qe.cpus = 2
        qe.net_device = "virtio-net"

        qe.qemuargs = [
            ["-device", "virtio-rng-pci"],
            ["-device", "virtio-balloon-pci"],
            ["-smp", "cpus=3,cores=3,threads=1"]
        ]
        qe.ssh_auto_correct = true
  end
  
  # Speed up SSH
  config.ssh.insert_key = false
  
  # Disable folder sync if not needed
  config.vm.synced_folder ".", "/vagrant", disabled: true
end
